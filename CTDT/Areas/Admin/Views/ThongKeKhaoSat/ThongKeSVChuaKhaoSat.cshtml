@{
    ViewBag.Title = "Thống kê sinh viên chưa thực hiện khảo sát - TDMU";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

<div class="main-content">
    <div class="page-header">
        <h2 class="header-title">Thống kê sinh viên chưa thực hiện khảo sát</h2>
        <div class="header-sub-title">
            <nav class="breadcrumb breadcrumb-dash">
                <a href="#" class="breadcrumb-item"><i class="anticon anticon-home m-r-5"></i>Home</a>
                <span class="breadcrumb-item active">Danh sách sinh viên chưa thực hiện khảo sát</span>
            </nav>
        </div>
    </div>
    <div class="card">
        <div class="card-body">
            <h4>Danh sách sinh viên chưa thực hiện khảo sát</h4>
            <div class="col-sm-10" style="margin-top: 10px;">
                <select id="MaCTDT" class="form-control">
                    <option value="">Tất cả</option>
                    @foreach (var item in ViewBag.CTDTList)
                    {
                        <option value="@item.Value">@item.Text</option>
                    }
                </select>
            </div>
            <div class="col-sm-10" style="margin-top: 10px;">
                <select id="MaPKS" class="form-control">
                    @foreach (var item in ViewBag.PKSList)
                    {
                        <option value="@item.Value">@item.Text</option>
                    }
                </select>
            </div>
            <div class="col-sm-10" style="margin-top: 10px;">
                <button type="button" class="btn btn-info btn-tone m-r-5" id="FilterSV">Tìm kiếm</button>
                <button type="button" class="btn btn-success btn-tone m-r-5">Xuất Excel</button>
            </div>
            <div id="data-table-section" class="m-t-25" style="display: none;">
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th scope="col">STT</th>
                                <th scope="col">Mã sinh viên</th>
                                <th scope="col">Họ và tên</th>
                                <th scope="col">Ngày sinh</th>
                                <th scope="col">Số điện thoại</th>
                                <th scope="col">CTĐT</th>
                                <th scope="col">Lớp</th>
                            </tr>
                        </thead>
                        <tbody id="showdata">
                            <!-- Data will be appended here by the script -->
                        </tbody>
                    </table>
                </div>
                <div id="pagination" class="m-t-15 pagination-right">
                    <!-- Pagination buttons will be inserted here -->
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        $("#FilterSV").click(function () {
            var selectCtdt = $("#MaCTDT").val();
            LoadData(selectCtdt);
        });
    });

    function LoadData(ctdt) {
        $.ajax({
            url: '/ThongKeKhaoSat/LoadSVChuaKhaoSat',
            type: 'GET',
            data: { ctdt: ctdt },
            success: function (res) {
                var items = res.data;
                var html = "";

                if (items.length === 0) {
                    html += "<tr><td colspan='7' class='text-center'>Không có dữ liệu</td></tr>";
                } else {
                    for (let i = 0; i < items.length; i++) {
                        var index = i + 1;
                        html += "<tr>";
                        html += "<td>" + index + "</td>";
                        html += "<td>" + items[i].MSSV + "</td>";
                        html += "<td>" + items[i].Hoten + "</td>";
                        html += "<td>" + items[i].NgaySinh + "</td>";
                        html += "<td>" + items[i].SDT + "</td>";
                        html += "<td>" + items[i].CTDT + "</td>";
                        html += "<td>" + items[i].Lop + "</td>";
                        html += "</tr>";
                    }
                }
                $('#showdata').html(html);
                $('#data-table-section').show();
            },
            error: function () {
                var html = "<tr><td colspan='7' class='text-center'>Không thể tải dữ liệu</td></tr>";
                $('#showdata').html(html);
                $('#data-table-section').show();
            }
        });
    }
</script>
